<template>
  <div class="relative">
    <img src="/img/crab.png" alt="" class="w-full h-full" />
    <div
      class="absolute top-0 left-0 min-w-full min-h-full flex content-center justify-center"
    >
      <svg
        class="w-9/12 h-9/12"
        xmlns="http://www.w3.org/2000/svg"
        viewBox="0 0 3000.000000 3000.000000"
      >
        <g>
          <title>Layer 1</title>

        
          <line
            :stroke="fill"
            stroke-width="50"
            id="svg_15"
            y2="2062.4988"
            x2="1247.50047"
            y1="2097.49862"
            x1="472.50212"
          />
          <line
            :stroke="fill"
            transform="rotate(-1.5441715717315674 417.50225830078193,1650.0009765625014) "
            stroke-width="50"
            id="svg_16"
            y2="1222.63583"
            x2="377.50057"
            y1="2077.36601"
            x1="457.50395"
          />
          <line
            :stroke="fill"
            stroke-width="50"
            id="svg_17"
            y2="1052.50069"
            x2="1102.50069"
            y1="1222.50039"
            x1="372.50233"
          />
          <line
            transform="rotate(0.6799801588058472 922.5011596679551,715.0015869140566) "
            :stroke="fill"
            stroke-width="50"
            id="svg_18"
            y2="1047.5004"
            x2="1052.50083"
            y1="382.50291"
            x1="792.50146"
          />
          <line
            :stroke="fill"
            stroke-width="50"
            id="svg_19"
            y2="147.5026"
            x2="1582.49978"
            y1="387.50199"
            x1="812.50142"
          />
          <line
            :stroke="fill"
            stroke-width="50"
            id="svg_20"
            y2="812.50135"
            x2="1757.49952"
            y1="172.50263"
            x1="1562.49993"
          />
          <line
            :stroke="fill"
            stroke-width="50"
            id="svg_21"
            y2="612.50184"
            x2="2402.49811"
            y1="817.50132"
            x1="1782.49943"
          />
          <line
            :stroke="fill"
            stroke-width="50"
            id="svg_22"
            y2="1212.50013"
            x2="2802.49741"
            y1="602.50151"
            x1="2387.4983"
          />
          <line
            :stroke="fill"
            stroke-width="50"
            id="svg_23"
            y2="1202.49997"
            x2="2797.49731"
            y1="1787.49963"
            x1="2657.49761"
          />
          <line
            :stroke="fill"
            stroke-width="50"
            id="svg_24"
            y2="1787.49947"
            x2="2652.49763"
            y1="1722.49945"
            x1="1912.4992"
          />
          <line
            :stroke="fill"
            transform="rotate(64.05621337890625 2113.5798339843755,2098.1906738281245) "
            stroke-width="50"
            id="svg_25"
            y2="2067.08109"
            x2="2554.73059"
            y1="2129.3002"
            x1="1672.42892"
          />
          <text
            font-style="normal"
            font-weight="normal"
            transform="matrix(3.946672129670344,0,0,3.9781749101912345,-3203.6254951727105,-6514.209892074055) "
            xml:space="preserve"
            text-anchor="start"
            font-family="'Poppins'"
            font-size="24"
            id="svg_27"
            y="2199.67777"
            x="1086.28625"
            opacity="undefined"
            fill-opacity="null"
            stroke-opacity="null"
            stroke-dasharray="null"
            stroke-width="0"
            :fill="fill"
          >
            Week 1
          </text>
          <text
            font-style="normal"
            font-weight="normal"
            stroke="#000"
            transform="matrix(3.946672129670344,0,0,3.9781749101912345,-3203.6254951727105,-6514.209892074055) "
            xml:space="preserve"
            text-anchor="start"
            font-family="'Poppins'"
            font-size="24"
            id="svg_28"
            y="2209.7324"
            x="884.85546"
            opacity="undefined"
            fill-opacity="null"
            stroke-opacity="null"
            stroke-dasharray="null"
            stroke-width="0"
            :fill="fill"
          >
            Week 2
          </text>
          <text
            style="cursor: move"
            font-style="normal"
            font-weight="normal"
            stroke="#000"
            transform="matrix(3.946672129670344,0,0,3.9781749101912345,-3203.6254951727105,-6514.209892074055) "
            xml:space="preserve"
            text-anchor="start"
            font-family="'Poppins'"
            font-size="24"
            id="svg_29"
            y="1920.66192"
            x="853.18394"
            opacity="undefined"
            fill-opacity="null"
            stroke-opacity="null"
            stroke-dasharray="null"
            stroke-width="0"
            :fill="fill"
          >
            Week 3
          </text>
          <text
            font-style="normal"
            font-weight="normal"
            stroke="#000"
            transform="matrix(3.946672129670344,0,0,3.9781749101912345,-3203.6254951727105,-6514.209892074055) "
            xml:space="preserve"
            text-anchor="start"
            font-family="'Poppins'"
            font-size="24"
            id="svg_30"
            y="1947.05531"
            x="1041.94614"
            opacity="undefined"
            fill-opacity="null"
            stroke-opacity="null"
            stroke-dasharray="null"
            stroke-width="0"
            :fill="fill"
          >
            Week 4
          </text>
          <text
            font-style="normal"
            font-weight="normal"
            stroke="#000"
            transform="matrix(3.946672129670344,0,0,3.9781749101912345,-3203.6254951727105,-6514.209892074055) "
            xml:space="preserve"
            text-anchor="start"
            font-family="'Poppins'"
            font-size="24"
            id="svg_31"
            y="1742.19232"
            x="900.65917"
            opacity="undefined"
            fill-opacity="null"
            stroke-opacity="null"
            stroke-dasharray="null"
            stroke-width="0"
            :fill="fill"
          >
            Week 5
          </text>
          <text
            style="cursor: move"
            font-style="normal"
            font-weight="normal"
            stroke="#000"
            transform="matrix(3.946672129670344,0,0,3.9781749101912345,-3203.6254951727105,-6514.209892074055) "
            xml:space="preserve"
            text-anchor="start"
            font-family="'Poppins'"
            font-size="24"
            id="svg_32"
            y="1684.37818"
            x="1238.30949"
            opacity="undefined"
            fill-opacity="null"
            stroke-opacity="null"
            stroke-dasharray="null"
            stroke-width="0"
            :fill="fill"
          >
            Week 6
          </text>
          <text
            style="cursor: move"
            font-style="normal"
            font-weight="normal"
            stroke="#000"
            transform="matrix(3.946672129670344,0,0,3.9781749101912345,-3203.6254951727105,-6514.209892074055) "
            xml:space="preserve"
            text-anchor="start"
            font-family="'Poppins'"
            font-size="24"
            id="svg_33"
            y="1881.70025"
            x="1218.03973"
            opacity="undefined"
            fill-opacity="null"
            stroke-opacity="null"
            stroke-dasharray="null"
            stroke-width="0"
           :fill="fill"
          >
            Week 7
          </text>
          <text
            style="cursor: move"
            font-style="normal"
            font-weight="normal"
            stroke="#000"
            transform="matrix(3.946672129670344,0,0,3.9781749101912345,-3203.6254951727105,-6514.209892074055) "
            xml:space="preserve"
            text-anchor="start"
            font-family="'Poppins'"
            font-size="24"
            id="svg_34"
            y="1774.86983"
            x="1433.40598"
            opacity="undefined"
            fill-opacity="null"
            stroke-opacity="null"
            stroke-dasharray="null"
            stroke-width="0"
            :fill="fill"
          >
            Week 8
          </text>
          <text
            font-style="normal"
            font-weight="normal"
            stroke="#000"
            transform="matrix(3.946672129670344,0,0,3.9781749101912345,-3203.6254951727105,-6514.209892074055) "
            xml:space="preserve"
            text-anchor="start"
            font-family="'Poppins'"
            font-size="24"
            id="svg_35"
            y="1949.56896"
            x="1410.73785"
            opacity="undefined"
            fill-opacity="null"
            stroke-opacity="null"
            stroke-dasharray="null"
            stroke-width="0"
            :fill="fill"
          >
            Week 9
          </text>
          <text
            font-style="normal"
            font-weight="normal"
            stroke="#000"
            transform="matrix(3.946672129670344,0,0,3.9781749101912345,-3203.6254951727105,-6514.209892074055) "
            xml:space="preserve"
            text-anchor="start"
            font-family="'Poppins'"
            font-size="24"
            id="svg_36"
            y="2129.2954"
            x="1435.93972"
            opacity="undefined"
            fill-opacity="null"
            stroke-opacity="null"
            stroke-dasharray="null"
            stroke-width="0"
           :fill="fill"
          >
            Week 10
          </text>
          <text
            font-style="normal"
            font-weight="normal"
            stroke="#000"
            transform="matrix(3.946672129670344,0,0,3.9781749101912345,-3203.6254951727105,-6514.209892074055) "
            xml:space="preserve"
            text-anchor="start"
            font-family="'Poppins'"
            font-size="24"
            id="svg_37"
            y="2076.50853"
            x="1180.16935"
            opacity="undefined"
            fill-opacity="null"
            stroke-opacity="null"
            stroke-dasharray="null"
            stroke-width="0"
            :fill="fill"
          >
            Week 11
          </text>
          <text
            font-style="normal"
            font-weight="normal"
            stroke="#000"
            transform="matrix(3.946672129670344,0,0,3.9781749101912345,-3203.6254951727105,-6514.209892074055) "
            xml:space="preserve"
            text-anchor="start"
            font-family="'Poppins'"
            font-size="24"
            id="svg_38"
            y="2307.765"
            x="1366.2624"
            opacity="undefined"
            fill-opacity="null"
            stroke-opacity="null"
            stroke-dasharray="null"
            stroke-width="0"
            :fill="fill"
          >
            Week 12
          </text>
        </g>
        <g v-for="(circle, index) in circles" :key="index">
          <circle v-if="currentWeek == index"
            fill="#FADB5F"
            :cx="circle.position.cx"
            :cy="circle.position.cy"
            :r="activeCircleRadius"
          />
          <circle v-if="currentWeek != index"
            :fill="fill"
            :cx="circle.position.cx"
            :cy="circle.position.cy"
            :r="circleRadius"
          />
          <circle
            :cx="circle.position.cx"
            :cy="circle.position.cy"
            :r="touchRadius"
            opacity="0"
            @click="onWeekClick(index)"
            @mouseover="hoverOn(circle)"
            @mouseleave="closePreview()"
            class="cursor-pointer"
          />
        </g>
      </svg>
      <img
        id="preview"
        :src="getImgUrl()"
        alt=""
        class="top-0 left-0 hidden fixed w-7/12 lg:w-96 z-50"
         v-click-outside="closePreview"
      />
    </div>
  </div>
</template>
<script>
import ClickOutside from "vue-click-outside";
export default {
  
  name: "Timeline",
  props : ["currentWeek"],
  data: function () {
    return {
      touchRadius: 200,
      circleRadius: 65,
      activeCircleRadius: 80,
      fill: "#2d3a8c",
      selected : null,
      circles: {
        1: {
          position: {
            cx: "1224.99905",
            cy: "2065.00637",
          },
          image: "tl1",
          popupDisplayX: "center",
          popupDisplayY: "top",
        },
        2: {
          position: {
            cx: "474.99213",
            cy: "2100.00563",
          },
          image: "tl2",
          popupDisplayX: "right",
          popupDisplayY: "top",
        },
        3: {
          position: {
            cx: "364.99122",
            cy: "1229.99949",
          },
          image: "tl3",
          popupDisplayX: "right",
          popupDisplayY: "center",
        },
        4: {
          position: {
            cx: "1054.99714",
            cy: "1064.99768",
          },
          image: "tl4",
          popupDisplayX: "center",
          popupDisplayY: "top",
        },
        5: {
          position: {
            cx: "799.99483",
            cy: "394.99146",
          },
          image: "tl5",
          popupDisplayX: "center",
          popupDisplayY: "buttom",
        },
        6: {
          position: {
            cx: "1554.99332",
            cy: "159.99194",
          },
          image: "tl6",
           popupDisplayX: "center",
          popupDisplayY: "buttom",
        },
        7: {
          position: {
            cx: "1764.99286",
            cy: "819.99061",
          },
          image: "tl7",
          popupDisplayX: "center",
          popupDisplayY: "buttom",
        },
        8: {
          position: {
            cx: "2389.99158",
            cy: "614.99101",
          },
          image: "tl8",
          popupDisplayX: "left",
          popupDisplayY: "buttom",
        },
        9: {
          position: {
            cx: "2799.99075",
            cy: "1204.98984",
          },
          image: "tl9",
          popupDisplayX: "left",
          popupDisplayY: "center",
        },
        10: {
          position: {
            cx: "2654.99104",
            cy: "1784.98864",
          },
          image: "tl10",
          popupDisplayX: "left",
          popupDisplayY: "top",
        },
        11: {
          position: {
            cx: "1904.99262",
            cy: "1714.98874",
          },
          image: "tl11",
          popupDisplayX: "center",
          popupDisplayY: "top",
        },
        12: {
          position: {
            cx: "2349.9925",
            cy: "2499.98908",
          },
          image: "tl12",
          popupDisplayX: "left",
          popupDisplayY: "top",
        },
      },
    };
  },
  methods: {
    getImgUrl(){
      if(this.selected){
        return "/card/timeline/"+this.selected.image+".png";
      }else{
        return ""
      }
      
    },
    onWeekClick() {
      var preview = document.getElementById("preview");
      preview.style.display = "block";
    },
    hoverOn(circle) {
      this.selected = circle
      var marginX = 0
      var marginY = 0
      var preview = document.getElementById("preview");
       preview.style.display = "block";
       const elemWidth = preview.offsetWidth
       const elemHeight = preview.offsetHeight
       const margin = 20
       if(circle.popupDisplayX){
         switch(circle.popupDisplayX){
           case 'left' : {marginX -= (elemWidth+margin);break;}
           case 'right' : {marginX = margin; break;}
           case 'center' : {marginX -= (elemWidth/2);break;}
           default: {marginX = margin; break;}
         }
       }
       
       if(circle.popupDisplayY){
         switch(circle.popupDisplayY){
           case 'top' : {marginY -= (elemHeight+margin);break;}
           case 'bottom' : {marginY = margin;break;}
           case 'center' : {marginY -= (elemHeight/2);break;}
           default: {marginY = margin;break;}
         }
       }else{
         marginY = margin
       }
      window.onmousemove = function (e) {
        var x = e.clientX,
          y = e.clientY;
        preview.style.top = y + marginY + "px";
        preview.style.left = x + marginX + "px";
        
      }
     
      
    },
    closePreview(){
var preview = document.getElementById("preview");
preview.style.display = "none";
      }
  },
   directives: {
    ClickOutside,
  },
};
</script>
<style>
</style>